---
- hosts: localhost
  remote_user: root
  roles:
    - inline_python

  tasks:
    - debug:
        msg: |
          -----------------------------------------------

          TEST #1 (simple):
          {% set output = """
          print(val1)
          """ | inline_python(val1="Some output") %}
          {{ output }}

    - debug:
        msg: |
          -----------------------------------------------

          TEST #2 (simple here-doc style):
          {% set output | inline_python(val1="Some output") %}
          print(val1)
          {% endset %}
          {{ output }}

    - debug:
        msg: |
          -----------------------------------------------

          TEST #2 (full here-doc style with variable manipulation):

          {% set fruit_inventory = {"apples": 3, "oranges": 6} %}
          {% set fruit_list = ["apples", "oranges"] %}

          {% set output | inline_python(title="Fruit:", my_inventory=fruit_inventory, my_list=fruit_list) %}
          print(title)
          print(my_list)
          print(my_inventory)

          my_inventory['lemons'] = 1000
          my_inventory['apples'] = 0
          my_list.append("bananas")
          
          {% endset %}
          [---BEFORE---]{{ output }}

          [---AFTER---]
          {{ fruit_list }}

          {{ fruit_inventory }}
          